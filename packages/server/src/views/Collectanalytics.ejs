<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirecting...</title>
    <% if (security) {%>
        <script src="https://cdn.tailwindcss.com"></script>
        <% } %>


            <style>
                .data {
                    display: none;
                }
            </style>
</head>

<body>

    <button type="button" class="data url cursor-pointer" data-url=<%=destination %>
        data-secure=<%= security %>
            data-id=<%= id %>
                data-ref=<%= ref %>
                    ></button>

    <% if (security) {%>
        <div
            class="container mx-auto my-[calc(100vh/5)] flex w-full max-w-fit flex-col items-center justify-center space-y-3 ">
            <div class="secure w-40">
                <svg version="1.1" id="svg2" xml:space="preserve" viewBox="0 0 666.66669 666.66669"
                    sodipodi:docname="123319-OQCGNQ-739.ai" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                    xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                    xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">
                    <defs id="defs6">
                        <clipPath clipPathUnits="userSpaceOnUse" id="clipPath16">
                            <path d="M 0,0 H 500 V 500 H 0 Z" id="path14" />
                        </clipPath>
                        <radialGradient fx="0" fy="0" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse"
                            gradientTransform="matrix(569.00745,0,0,-569.00745,250,250)" spreadMethod="pad"
                            id="radialGradient32">
                            <stop style="stop-opacity:0;stop-color:#ffffff" offset="0" id="stop26" />
                            <stop style="stop-opacity:0;stop-color:#ffffff" offset="0.58578754" id="stop28" />
                            <stop style="stop-opacity:0.29999237;stop-color:#ffffff" offset="1" id="stop30" />
                        </radialGradient>
                        <mask maskUnits="userSpaceOnUse" x="0" y="0" width="1" height="1" id="mask34">
                            <g id="g44">
                                <g id="g42">
                                    <g id="g40">
                                        <g id="g38">
                                            <path d="M -32768,32767 H 32767 V -32768 H -32768 Z"
                                                style="fill:url(#radialGradient32);stroke:none" id="path36" />
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </mask>
                        <radialGradient fx="0" fy="0" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse"
                            gradientTransform="matrix(569.00745,0,0,-569.00745,250,250)" spreadMethod="pad"
                            id="radialGradient56">
                            <stop style="stop-opacity:1;stop-color:#ffffff" offset="0" id="stop50" />
                            <stop style="stop-opacity:1;stop-color:#ffffff" offset="0.58578754" id="stop52" />
                            <stop style="stop-opacity:1;stop-color:#1d1e1c" offset="1" id="stop54" />
                        </radialGradient>
                        <clipPath clipPathUnits="userSpaceOnUse" id="clipPath66">
                            <path
                                d="M 51.753,250 C 51.753,140.511 140.512,51.753 250,51.753 v 0 c 109.489,0 198.247,88.758 198.247,198.247 v 0 c 0,109.489 -88.758,198.247 -198.247,198.247 v 0 C 140.512,448.247 51.753,359.489 51.753,250"
                                id="path64" />
                        </clipPath>
                        <clipPath clipPathUnits="userSpaceOnUse" id="clipPath78">
                            <path d="M 148.291,365.5 H 475.768 V 10.5879 H 148.291 Z" id="path76" />
                        </clipPath>
                        <linearGradient x1="0" y1="0" x2="1" y2="0" gradientUnits="userSpaceOnUse"
                            gradientTransform="matrix(233.70181,-229.40091,-229.40091,-233.70181,224.80615,300.05322)"
                            spreadMethod="pad" id="linearGradient88">
                            <stop style="stop-opacity:1;stop-color:#221e1f" offset="0" id="stop84" />
                            <stop style="stop-opacity:1;stop-color:#ffffff" offset="1" id="stop86" />
                        </linearGradient>
                        <clipPath clipPathUnits="userSpaceOnUse" id="clipPath126">
                            <path d="M 0,500 H 500 V 0 H 0 Z" id="path124" />
                        </clipPath>
                    </defs>
                    <sodipodi:namedview id="namedview4" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0"
                        inkscape:pageshadow="2" inkscape:pageopacity="0.0" inkscape:pagecheckerboard="0" />
                    <g id="g8" inkscape:groupmode="layer" inkscape:label="123319-OQCGNQ-739"
                        transform="matrix(1.3333333,0,0,-1.3333333,0,666.66667)">
                        <g id="g10">
                            <g id="g12" clip-path="url(#clipPath16)">
                                <g id="g18">
                                    <g id="g20" />
                                    <g id="g46" mask="url(#mask34)">
                                        <g id="g48">
                                            <path d="M 0,0 H 500 V 500 H 0 Z"
                                                style="fill:url(#radialGradient56);stroke:none" id="path58" />
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                        <g id="g60">
                            <g id="g62" clip-path="url(#clipPath66)">
                                <g id="g68" transform="translate(448.2471,250)">
                                    <path
                                        d="m 0,0 c 0,-109.489 -88.758,-198.247 -198.247,-198.247 -109.489,0 -198.247,88.758 -198.247,198.247 0,109.489 88.758,198.247 198.247,198.247 C -88.758,198.247 0,109.489 0,0"
                                        style="fill:#ffcb21;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path70" />
                                </g>
                                <g id="g72">
                                    <g id="g74" />
                                    <g id="g102">
                                        <g clip-path="url(#clipPath78)" opacity="0.5" id="g100">
                                            <g id="g98">
                                                <g id="g96">
                                                    <g id="g94">
                                                        <g id="g92">
                                                            <path
                                                                d="m 464.874,180.249 c 0,7.747 10.894,21.691 10.894,21.691 l -6.875,27.89 C 468.59,229.673 349.375,345 349.375,345 321.682,330.676 298.836,326.459 283.38,332.309 c -3.324,1.258 -6.335,3.21 -8.88,5.691 -7.198,7.016 -22.5,27.5 -22.5,27.5 0,0 -29.337,-57.036 -96.737,-22.174 l -6.972,-27.89 c 0,0 10.846,-13.945 10.846,-21.692 0,-7.831 -1.07,-15.69 -1.182,-23.537 -0.219,-15.251 0.853,-30.575 3.824,-45.55 3.494,-17.606 9.742,-34.568 19.797,-49.506 3.432,-5.098 7.439,-9.547 11.823,-13.564 0.438,-0.418 118.379,-111.839 118.825,-112.248 9.786,-9.34 21.635,-16.329 33.367,-23.389 2.815,-1.694 5.678,-3.31 8.61,-4.791 10.559,-5.33 18.047,-10.571 18.047,-10.571 0,0 7.939,4.732 18.411,10.846 7.88,4.599 14.827,8.39 21.905,13.118 8.813,5.886 17.747,11.802 24.621,19.975 6.661,7.919 11.845,17.007 15.894,26.506 2.096,4.915 3.89,9.957 5.423,15.074 4.529,15.124 6.711,30.899 7.364,46.649 0.446,10.724 0.122,21.448 -0.653,32.148 -0.129,1.774 -0.339,3.565 -0.339,5.345"
                                                                style="fill:url(#linearGradient88);stroke:none"
                                                                id="path90" />
                                                        </g>
                                                    </g>
                                                </g>
                                            </g>
                                        </g>
                                    </g>
                                </g>
                                <g id="g104" transform="translate(355.6221,315.436)">
                                    <path
                                        d="m 0,0 -6.875,27.89 c -67.399,-34.862 -96.646,20.529 -96.646,20.529 0,0 -29.438,-55.391 -96.838,-20.529 L -207.331,0 c 0,0 10.846,-13.945 10.846,-21.692 0,-7.831 -1.07,-15.69 -1.182,-23.537 -0.219,-15.251 0.853,-30.575 3.824,-45.55 3.494,-17.606 9.742,-34.569 19.797,-49.506 10.702,-15.899 26.947,-25.528 43.045,-35.21 2.912,-1.751 5.846,-3.491 8.888,-5.012 10.845,-5.423 18.592,-10.846 18.592,-10.846 0,0 7.94,4.733 18.413,10.846 7.879,4.6 14.826,8.39 21.905,13.119 8.811,5.887 17.746,11.802 24.62,19.975 6.66,7.919 11.846,17.007 15.895,26.506 2.094,4.915 3.889,9.956 5.422,15.074 4.53,15.125 6.71,30.898 7.365,46.648 0.445,10.725 0.121,21.449 -0.654,32.149 -0.129,1.774 -0.34,3.564 -0.34,5.344 C -10.895,-13.945 0,0 0,0"
                                        style="fill:#2581f3;fill-opacity:1;fill-rule:nonzero;stroke:none"
                                        id="path106" />
                                </g>
                                <g id="g108" transform="translate(355.6221,315.436)">
                                    <path
                                        d="m 0,0 -6.875,27.89 c -67.399,-34.862 -96.646,20.529 -96.646,20.529 0,0 -29.438,-55.391 -96.838,-20.529 L -207.331,0 c 0,0 10.846,-13.945 10.846,-21.692 0,-7.831 -1.07,-15.69 -1.182,-23.537 -0.219,-15.251 0.853,-30.575 3.824,-45.55 3.494,-17.606 9.742,-34.569 19.797,-49.506 10.702,-15.899 26.947,-25.528 43.045,-35.21 2.912,-1.751 5.846,-3.491 8.888,-5.012 10.845,-5.423 18.592,-10.846 18.592,-10.846 0,0 7.94,4.733 18.413,10.846 7.879,4.6 14.826,8.39 21.905,13.119 8.811,5.887 17.746,11.802 24.62,19.975 6.66,7.919 11.846,17.007 15.895,26.506 2.094,4.915 3.889,9.956 5.422,15.074 4.53,15.125 6.71,30.898 7.365,46.648 0.445,10.725 0.121,21.449 -0.654,32.149 -0.129,1.774 -0.34,3.564 -0.34,5.344 C -10.895,-13.945 0,0 0,0 Z"
                                        style="fill:none;stroke:#ffffff;stroke-width:3;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-dasharray:none;stroke-opacity:1"
                                        id="path110" />
                                </g>
                                <g id="g112" transform="translate(252.0879,362.394)">
                                    <path
                                        d="m 0,0 -6.827,-7.942 c -8.879,-10.329 -24.415,-22.641 -48.007,-22.642 -10.212,0 -21.132,2.379 -32.459,7.073 l -9.645,3.997 -2.532,-10.129 -3.303,-13.214 -0.996,-3.981 2.354,-3.363 c 5.299,-7.57 8.462,-14.466 8.462,-18.448 0,-4.129 -0.302,-8.335 -0.595,-12.402 -0.275,-3.831 -0.535,-7.431 -0.587,-11.137 -0.233,-16.259 1.053,-31.585 3.824,-45.55 3.753,-18.908 10.414,-35.564 19.797,-49.506 10.547,-15.668 25.989,-24.954 42.338,-34.785 l 0.718,-0.43 c 2.938,-1.769 5.838,-3.488 8.878,-5.008 5.953,-2.977 10.927,-5.928 14.052,-7.88 l 4.64,-2.899 4.71,2.786 c 3.09,1.828 7.959,4.698 13.604,7.992 1.79,1.046 3.53,2.048 5.233,3.028 l 0.287,0.165 c 5.653,3.252 10.988,6.321 16.387,9.929 l 0.37,0.246 c 8.988,6.004 17.472,11.67 24.25,19.729 6.183,7.351 11.53,16.269 15.895,26.507 2.025,4.753 3.849,9.824 5.422,15.075 4.181,13.961 6.66,29.657 7.365,46.652 0.411,9.908 0.197,20.425 -0.655,32.155 -0.034,0.47 -0.073,0.946 -0.113,1.416 l -0.006,0.07 c -0.108,1.279 -0.219,2.589 -0.219,3.89 0,4.01 3.18,10.927 8.508,18.502 l 2.354,3.348 -0.975,3.974 -3.253,13.261 -2.493,10.162 -9.676,-3.985 c -11.111,-4.577 -22.018,-6.897 -32.418,-6.897 -23.732,0 -39.127,12.124 -47.864,22.296 z m -0.003,-13.714 c 9.292,-10.817 26.979,-25.48 54.692,-25.48 11.599,0 23.636,2.523 35.846,7.552 l 3.253,-13.272 c -4.184,-5.949 -10.146,-15.815 -10.146,-23.687 0,-1.682 0.133,-3.257 0.251,-4.644 0.039,-0.461 0.078,-0.931 0.112,-1.387 0.825,-11.389 1.034,-21.572 0.638,-31.131 -0.674,-16.246 -3.028,-31.199 -6.996,-44.444 -1.475,-4.928 -3.184,-9.683 -5.079,-14.128 -4.014,-9.417 -8.893,-17.574 -14.504,-24.243 -5.953,-7.079 -13.919,-12.4 -22.353,-18.034 l -0.377,-0.251 c -5.143,-3.434 -10.354,-6.433 -15.872,-9.608 l -0.259,-0.15 c -1.73,-0.996 -3.497,-2.013 -5.313,-3.074 -5.575,-3.253 -10.474,-6.14 -13.65,-8.019 -3.645,2.277 -8.756,5.277 -14.795,8.297 -2.751,1.375 -5.483,2.997 -8.274,4.675 l -0.706,0.424 c -15.469,9.302 -30.081,18.089 -39.512,32.1 -8.714,12.946 -14.916,28.501 -18.436,46.232 -2.648,13.346 -3.877,28.039 -3.653,43.67 0.049,3.45 0.3,6.929 0.565,10.612 0.303,4.228 0.618,8.6 0.618,13.055 0,7.823 -5.927,17.664 -10.089,23.609 l 3.304,13.31 c 12.43,-5.151 24.489,-7.664 35.902,-7.664 h 0.003 c 27.579,0 45.42,14.733 54.83,25.68"
                                        style="fill:#fcfcfc;fill-opacity:1;fill-rule:nonzero;stroke:none"
                                        id="path114" />
                                </g>
                                <g id="g116" transform="translate(265,255)">
                                    <path
                                        d="m 0,0 h -27 v 14.9 c 0,8.015 5.486,14.543 13.5,14.543 C -5.479,29.443 0,22.915 0,14.9 Z m -8.552,-27.297 v -12.001 h -8.469 v 12.001 c -1.693,1.276 -2.796,3.383 -2.796,5.76 0,3.901 3.254,7.058 7.15,7.058 0.007,0 0.038,-0.001 0.046,-0.001 0.008,0 0.026,0.001 0.034,0.001 3.901,0 7.037,-3.157 7.037,-7.058 0,-2.377 -1.307,-4.484 -3.002,-5.76 M 12,0 V 13.604 C 12,19.882 9.792,25.636 5.992,30.057 1.352,35.454 -5.296,38.875 -12.952,38.875 -26.887,38.875 -38,27.538 -38,13.604 V 0 h -7 V -54 H 19 V 0 Z"
                                        style="fill:#fcfcfc;fill-opacity:1;fill-rule:nonzero;stroke:none"
                                        id="path118" />
                                </g>
                            </g>
                        </g>
                        <g id="g120">
                            <g id="g122" clip-path="url(#clipPath126)">
                                <g id="g128" transform="translate(248.5806,30.8906)"></g>
                            </g>
                        </g>
                    </g>
                </svg>
            </div>
            <span class="currenturl text-center text-sm font-normal">http://localhost:4000/ineuron</span>
            <span class="warning text-center text-lg font-semibold capitalize text-blue-500">This url is password
                protected</span>
            <form>
                <div class="pass relative flex flex-col items-center justify-center space-y-4">
                    <input class="w-60 rounded-full py-2 px-5 text-center outline outline-1 outline-blue-500"
                        type="password" name="pass" id="pass" required placeholder="Enter Password" />
                    <span class="incorrect hidden text-center capitalize text-red-500">incorrect password, try
                        again</span>
                    <span class="wrongpass hidden text-center capitalize text-red-500">Password must be atleast<br />6
                        characters
                        long and contains<br />only alphabets and numbers</span>

                    <input class="hidden" type="text" id="pathid" value=<%=id %> >

                    <input class="hidden" type="text" id="refid" value=<%=ref %> >

                    <button id="loginform" type="submit"
                        class="w-full text-white bg-gradient-to-r from-blue-500 via-blue-600 to-blue-700 hover:bg-gradient-to-br font-medium rounded-full text-sm px-5 py-2.5 text-center mr-2 mb-2">Submit</button>
                </div>
            </form>
        </div>


        <script type='text/javascript'>
            let local_URL = '<%= baseurl %>';
            document.getElementById('loginform').addEventListener('click', async (e) => {
                e.preventDefault();
                const securecode = document.getElementById('pass').value;
                const pathid = document.getElementById('pathid').value;
                const refid = document.getElementById('refid').value;
                const inputdata = new RegExp(/[a-zA-Z0-9]{6,}/g).test(securecode)
                if (inputdata) {

                    const res = await fetch(`${local_URL}/redirect/protection`, {
                        method: 'POST',
                        headers: { 'Accept': 'application/json', 'Content-Type': 'application/json; charset=utf-8' },
                        body: JSON.stringify({
                            securecode,
                            pathid,
                            refid
                        })
                    })

                    const data = await res.json();

                    if (data.authentication === 'successfull' && data.destination) {
                        window.location.replace(data.destination);
                    } else {
                        const incorrect = document.querySelector('.incorrect')
                        incorrect.style.display = 'block';
                        document.querySelector('.wrongpass').style.display = 'none';
                        document.getElementById('pass').value = ''
                    }
                } else {
                    document.querySelector('.wrongpass').style.display = 'block';
                    document.querySelector('.incorrect').style.display = 'none';
                }


            })
        </script>
        <% } %>


            <script type='text/javascript'>
                local_URL = '<%= baseurl %>';
                const data = document.querySelector('.url').dataset;
                try {
                    console.log(data)
                    var canvas = document.createElement("canvas")
                    var webgl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl")
                    var debugInfo = webgl.getExtension("webgl_debug_renderer_info");
                    var gpu = webgl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);

                    try { var userAgentData = window.navigator.userAgentData; }
                    catch (error) { var userAgentData = null; }

                    const userdetails = {

                        user_screen: {
                            height: window.screen.height,
                            width: window.screen.width,
                            colorDepth: window.screen.colorDepth,
                            pixelDepth: window.screen.pixelDepth,
                            orientation: {
                                angle: window.screen.orientation.angle,
                                type: window.screen.orientation.type
                            },
                        },

                        user_device: {
                            os: userAgentData ? userAgentData.platform : null,
                            platform: window.navigator.platform,
                            mobile: userAgentData ? userAgentData.mobile : true,
                            gpu_info: gpu,
                            cpu_threads: window.navigator.hardwareConcurrency,
                            maxTouchPoints: window.navigator.maxTouchPoints
                        },
                        user_browser: {
                            browser: userAgentData ? userAgentData.brands[2] : null,
                            language: window.navigator.languages,
                            user_agent: window.navigator.userAgent,
                            appVersion: window.navigator.appVersion,
                        }

                    }

                    const sendanalytics = async () => {
                        const user = await fetch('http://ip-api.com/json', { method: 'GET' })
                        const user_info = await user.json();
                        delete user_info.status;
                        delete user_info.lat;
                        delete user_info.lon;
                        userdetails.user_info = user_info;
                        userdetails.pathid = data.id;
                        userdetails.refid = data.ref;

                        const response = await fetch(`${local_URL}/redirect/data`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(userdetails)
                        })

                        const finalres = await response.json();

                        console.log(finalres)
                        if (finalres.request && data.secure === 'false') {
                            window.location.replace(data.url);
                        }
                        // return response;



                    }

                    sendanalytics();


                } catch (err) {
                    console.log(err)
                    window.location.replace(data.url);

                }

            </script>


</body>

</html>